<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Modeling</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navegación principal -->
    <nav class="navigation">
        <a href="index.html" class="nav-logo">Sabrina Chmaili</a>
        <div class="nav-links">
            <a href="index.html" class="nav-link">Inicio</a>
            <a href="sobre-mi.html" class="nav-link">Sobre mí</a>
            <a href="portfolio.html" class="nav-link active">Portfolio</a>
            <a href="contacto.html" class="nav-link">Contacto</a>
        </div>
    </nav>

    <!-- Contenido principal -->
    <main class="content page-content">
        <h1>Portfolio - Modeling</h1>
        <!-- Grid Masonry del Portfolio -->
        <div id="portfolio-grid" class="portfolio-gallery">
            <!-- Columna 1 (23 imágenes) -->
            <div class="portfolio-gallery-column">
                <!-- Galucci (1-6) -->
                <img src="Assets/portafolio-sabrina-webp/galucci/galucci-1.webp" alt="Galucci 1" loading="eager" data-index="0" data-cloudinary-id="galucci-1_z6h48m">
                <img src="Assets/portafolio-sabrina-webp/galucci/galucci-2.webp" alt="Galucci 2" loading="eager" data-index="1" data-cloudinary-id="galucci-2_x3gj3b">
                <img data-src="Assets/portafolio-sabrina-webp/galucci/galucci-3.webp" alt="Galucci 3" data-index="2" data-cloudinary-id="galucci-3_b7eybh">
                <img data-src="Assets/portafolio-sabrina-webp/galucci/galucci-4.webp" alt="Galucci 4" data-index="3" data-cloudinary-id="galucci-4_y10vov">
                <img data-src="Assets/portafolio-sabrina-webp/galucci/galucci-5.webp" alt="Galucci 5" data-index="4" data-cloudinary-id="galucci-5_sffyjg">
                <img data-src="Assets/portafolio-sabrina-webp/galucci/galucci-6.webp" alt="Galucci 6" data-index="5" data-cloudinary-id="galucci-6_kkl2le">
                
                <!-- Halloween 2024 (1-3) -->
                <img src="Assets/portafolio-sabrina-webp/halloween-2024/halloween-2024-1.webp" alt="Halloween 2024 1" loading="eager" data-index="6" data-cloudinary-id="halloween-2024-1_cvgoio">
                <img data-src="Assets/portafolio-sabrina-webp/halloween-2024/halloween-2024-2.webp" alt="Halloween 2024 2" data-index="7" data-cloudinary-id="halloween-2024-2_mdhmbl">
                <img data-src="Assets/portafolio-sabrina-webp/halloween-2024/halloween-2024-3.webp" alt="Halloween 2024 3" data-index="8" data-cloudinary-id="halloween-2024-3_vbxuse">
                
                <!-- María Lafuente (1-5) -->
                <img src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-1.webp" alt="María Lafuente 1" loading="eager" data-index="9" data-cloudinary-id="marialafuente-1_d03swy">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-2.webp" alt="María Lafuente 2" data-index="10" data-cloudinary-id="marialafuente-2_rm2qv9">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-3.webp" alt="María Lafuente 3" data-index="11" data-cloudinary-id="marialafuente-3_yu0gij">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-4.webp" alt="María Lafuente 4" data-index="12" data-cloudinary-id="marialafuente-4_o8qsfd">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-5.webp" alt="María Lafuente 5" data-index="13" data-cloudinary-id="marialafuente-5_rygd4t">
                
                <!-- Otras (5 imágenes) -->
                <img data-src="Assets/portafolio-sabrina-webp/otras/macias-mirella-1.webp" alt="Macías Mirella 1" data-index="14" data-cloudinary-id="macias-mirella-1_nlzqio">
                <img data-src="Assets/portafolio-sabrina-webp/otras/pasarela-espanola-1.webp" alt="Pasarela Española 1" data-index="15" data-cloudinary-id="pasarela-espanola-1_ezcux6">
                <img data-src="Assets/portafolio-sabrina-webp/otras/pasarela-espanola-2.webp" alt="Pasarela Española 2" data-index="16" data-cloudinary-id="pasarela-espanola-2_zghvqi">
                <img data-src="Assets/portafolio-sabrina-webp/otras/pasarela-espanola-3.webp" alt="Pasarela Española 3" data-index="17" data-cloudinary-id="pasarela-espanola-3_bp0l4o">
                <img data-src="Assets/portafolio-sabrina-webp/otras/pasarela-espanola-4.webp" alt="Pasarela Española 4" data-index="18" data-cloudinary-id="pasarela-espanola-4_d9ofvo">
                
                <!-- Rojito - inicio (ivana-picallo, maisonmesa) -->
                <img data-src="Assets/portafolio-sabrina-webp/rojito/ivana-picallo-1.webp" alt="Ivana Picallo 1" data-index="19" data-cloudinary-id="ivana-picallo-1_ccez7f">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/maisonmesa-1.webp" alt="Maison Mesa 1" data-index="20" data-cloudinary-id="maisonmesa-1_x8zhbl">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/maisonmesa-2.webp" alt="Maison Mesa 2" data-index="21" data-cloudinary-id="maisonmesa-2_gudbti">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/maisonmesa-3.webp" alt="Maison Mesa 3" data-index="22" data-cloudinary-id="maisonmesa-3_j39kxs">
            </div>
            <!-- Columna 2 (24 imágenes) -->
            <div class="portfolio-gallery-column">
                <!-- María Lafuente (6-10) -->
                <img src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-6.webp" alt="María Lafuente 6" loading="eager" data-index="23" data-cloudinary-id="marialafuente-6_vm2ddu">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-7.webp" alt="María Lafuente 7" data-index="24" data-cloudinary-id="marialafuente-7_ylq5zy">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-8.webp" alt="María Lafuente 8" data-index="25" data-cloudinary-id="marialafuente-8_bi6cgl">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-9.webp" alt="María Lafuente 9" data-index="26" data-cloudinary-id="marialafuente-9_t2bhkw">
                <img data-src="Assets/portafolio-sabrina-webp/marialafuente/marialafuente-10.webp" alt="María Lafuente 10" data-index="27" data-cloudinary-id="marialafuente-10_ogfcvk">
                
                <!-- Rojito - rojito (1-11) -->
                <img src="Assets/portafolio-sabrina-webp/rojito/rojito-1.webp" alt="Rojito 1" loading="eager" data-index="28" data-cloudinary-id="rojito-1_waluvr">
                <img src="Assets/portafolio-sabrina-webp/rojito/rojito-2.webp" alt="Rojito 2" loading="eager" data-index="29" data-cloudinary-id="rojito-2_mxrhnd">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-3.webp" alt="Rojito 3" data-index="30" data-cloudinary-id="rojito-3_o9jtrk">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-4.webp" alt="Rojito 4" data-index="31" data-cloudinary-id="rojito-4_t02r4b">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-5.webp" alt="Rojito 5" data-index="32" data-cloudinary-id="rojito-5_ofoonu">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-6.webp" alt="Rojito 6" data-index="33" data-cloudinary-id="rojito-6_cv82ys">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-7.webp" alt="Rojito 7" data-index="34" data-cloudinary-id="rojito-7_vtqt5c">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-8.webp" alt="Rojito 8" data-index="35" data-cloudinary-id="rojito-8_r9nqvi">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-9.webp" alt="Rojito 9" data-index="36" data-cloudinary-id="rojito-9_bmu6ts">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-10.webp" alt="Rojito 10" data-index="37" data-cloudinary-id="rojito-10_idipza">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-11.webp" alt="Rojito 11" data-index="38" data-cloudinary-id="rojito-11_qyizuc">
                
                <!-- Rojito - vulkano (1-3) -->
                <img data-src="Assets/portafolio-sabrina-webp/rojito/vulkano-1.webp" alt="Vulkano 1" data-index="39" data-cloudinary-id="vulkano-1_uur4ht">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/vulkano-2.webp" alt="Vulkano 2" data-index="40" data-cloudinary-id="vulkano-2_bxtqo0">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/vulkano-3.webp" alt="Vulkano 3" data-index="41" data-cloudinary-id="vulkano-3_oltwt8">
                
                <!-- Sesión Pablo - carpeta 1 (1-2) -->
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/1/sesion-pablo-1-1.webp" alt="Sesión Pablo 1-1" data-index="42" data-cloudinary-id="sesion-pablo-1-1_wkytp9">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/1/sesion-pablo-1-2.webp" alt="Sesión Pablo 1-2" data-index="43" data-cloudinary-id="sesion-pablo-1-2_nd3phv">
                
                <!-- Tiscareno (1-3) -->
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-1.webp" alt="Tiscareno 1" data-index="44" data-cloudinary-id="tiscareno-1_c2jeua">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-2.webp" alt="Tiscareno 2" data-index="45" data-cloudinary-id="tiscareno-2_badsgb">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-3.webp" alt="Tiscareno 3" data-index="46" data-cloudinary-id="tiscareno-3_ewj6ma">
            </div>
            <!-- Columna 3 (23 imágenes) -->
            <div class="portfolio-gallery-column">
                <!-- Rojito - rojito (12-21) -->
                <img src="Assets/portafolio-sabrina-webp/rojito/rojito-12.webp" alt="Rojito 12" loading="eager" data-index="47" data-cloudinary-id="rojito-12_hnofzj">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-13.webp" alt="Rojito 13" data-index="48" data-cloudinary-id="rojito-13_zlk1si">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-14.webp" alt="Rojito 14" data-index="49" data-cloudinary-id="rojito-14_nu1d5f">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-15.webp" alt="Rojito 15" data-index="50" data-cloudinary-id="rojito-15_yz0kf3">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-16.webp" alt="Rojito 16" data-index="51" data-cloudinary-id="rojito-16_lkm963">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-17.webp" alt="Rojito 17" data-index="52" data-cloudinary-id="rojito-17_v72lqe">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-18.webp" alt="Rojito 18" data-index="53" data-cloudinary-id="rojito-18_adtlvu">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-19.webp" alt="Rojito 19" data-index="54" data-cloudinary-id="rojito-19_tgmnln">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-20.webp" alt="Rojito 20" data-index="55" data-cloudinary-id="rojito-20_ss7wsd">
                <img data-src="Assets/portafolio-sabrina-webp/rojito/rojito-21.webp" alt="Rojito 21" data-index="56" data-cloudinary-id="rojito-21_bqphdk">
                
                <!-- Sesión Pablo - carpeta 1 (3-5) -->
                <img src="Assets/portafolio-sabrina-webp/sesion-pablo/1/sesion-pablo-1-3.webp" alt="Sesión Pablo 1-3" loading="eager" data-index="57" data-cloudinary-id="sesion-pablo-1-3_kngjuy">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/1/sesion-pablo-1-4.webp" alt="Sesión Pablo 1-4" data-index="58" data-cloudinary-id="sesion-pablo-1-4_nuxekk">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/1/sesion-pablo-1-5.webp" alt="Sesión Pablo 1-5" data-index="59" data-cloudinary-id="sesion-pablo-1-5_fcweax">
                
                <!-- Sesión Pablo - carpeta 2 (1-5) -->
                <img src="Assets/portafolio-sabrina-webp/sesion-pablo/2/sesion-pablo-2-1.webp" alt="Sesión Pablo 2-1" loading="eager" data-index="60" data-cloudinary-id="sesion-pablo-2-1_lrsrph">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/2/sesion-pablo-2-2.webp" alt="Sesión Pablo 2-2" data-index="61" data-cloudinary-id="sesion-pablo-2-2_xw4vei">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/2/sesion-pablo-2-3.webp" alt="Sesión Pablo 2-3" data-index="62" data-cloudinary-id="sesion-pablo-2-3_vxxuvx">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/2/sesion-pablo-2-4.webp" alt="Sesión Pablo 2-4" data-index="63" data-cloudinary-id="sesion-pablo-2-4_ipth0b">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/2/sesion-pablo-2-5.webp" alt="Sesión Pablo 2-5" data-index="64" data-cloudinary-id="sesion-pablo-2-5_i9kjvd">
                
                <!-- Sesión Pablo - carpeta 3 (1-4) -->
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-1.webp" alt="Sesión Pablo 3-1" data-index="65" data-cloudinary-id="sesion-pablo-3-1_gjcgwe">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-2.webp" alt="Sesión Pablo 3-2" data-index="66" data-cloudinary-id="sesion-pablo-3-2_leimt6">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-3.webp" alt="Sesión Pablo 3-3" data-index="67" data-cloudinary-id="sesion-pablo-3-3_uyptlu">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-4.webp" alt="Sesión Pablo 3-4" data-index="68" data-cloudinary-id="sesion-pablo-3-4_anrcip">
            </div>
            <!-- Columna 4 (23 imágenes) -->
            <div class="portfolio-gallery-column">
                <!-- Sesión Pablo - carpeta 3 (5-6) -->
                <img src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-5.webp" alt="Sesión Pablo 3-5" loading="eager" data-index="69" data-cloudinary-id="sesion-pablo-3-5_ufaodi">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/3/sesion-pablo-3-6.webp" alt="Sesión Pablo 3-6" data-index="70" data-cloudinary-id="sesion-pablo-3-6_xk1swy">
                
                <!-- Sesión Pablo - carpeta 4 (1-7) -->
                <img src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-1.webp" alt="Sesión Pablo 4-1" loading="eager" data-index="71" data-cloudinary-id="sesion-pablo-4-1_cseghu">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-2.webp" alt="Sesión Pablo 4-2" data-index="72" data-cloudinary-id="sesion-pablo-4-2_ih64eo">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-3.webp" alt="Sesión Pablo 4-3" data-index="73" data-cloudinary-id="sesion-pablo-4-3_xgcycb">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-4.webp" alt="Sesión Pablo 4-4" data-index="74" data-cloudinary-id="sesion-pablo-4-4_kvtwen">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-5.webp" alt="Sesión Pablo 4-5" data-index="75" data-cloudinary-id="sesion-pablo-4-5_uublh0">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-6.webp" alt="Sesión Pablo 4-6" data-index="76" data-cloudinary-id="sesion-pablo-4-6_ywy6mc">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/4/sesion-pablo-4-7.webp" alt="Sesión Pablo 4-7" data-index="77" data-cloudinary-id="sesion-pablo-4-7_th2bfh">
                
                <!-- Sesión Pablo - carpeta 5 (1-5) -->
                <img src="Assets/portafolio-sabrina-webp/sesion-pablo/5/sesion-pablo-5-1.webp" alt="Sesión Pablo 5-1" loading="eager" data-index="78" data-cloudinary-id="sesion-pablo-5-1_kdu4cu">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/5/sesion-pablo-5-2.webp" alt="Sesión Pablo 5-2" data-index="79" data-cloudinary-id="sesion-pablo-5-2_mhbffr">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/5/sesion-pablo-5-3.webp" alt="Sesión Pablo 5-3" data-index="80" data-cloudinary-id="sesion-pablo-5-3_qtuivr">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/5/sesion-pablo-5-4.webp" alt="Sesión Pablo 5-4" data-index="81" data-cloudinary-id="sesion-pablo-5-4_borwkg">
                <img data-src="Assets/portafolio-sabrina-webp/sesion-pablo/5/sesion-pablo-5-5.webp" alt="Sesión Pablo 5-5" data-index="82" data-cloudinary-id="sesion-pablo-5-5_seyz8u">
                
                <!-- Tiscareno (4-13) -->
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-4.webp" alt="Tiscareno 4" data-index="83" data-cloudinary-id="tiscareno-4_mediad">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-5.webp" alt="Tiscareno 5" data-index="84" data-cloudinary-id="tiscareno-5_adb6fc">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-6.webp" alt="Tiscareno 6" data-index="85" data-cloudinary-id="tiscareno-6_uvg9ub">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-7.webp" alt="Tiscareno 7" data-index="86" data-cloudinary-id="tiscareno-7_ctz401">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-8.webp" alt="Tiscareno 8" data-index="87" data-cloudinary-id="tiscareno-8_fjmcml">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-9.webp" alt="Tiscareno 9" data-index="88" data-cloudinary-id="tiscareno-9_yqa69g">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-10.webp" alt="Tiscareno 10" data-index="89" data-cloudinary-id="tiscareno-10_okcsts">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-11.webp" alt="Tiscareno 11" data-index="90" data-cloudinary-id="tiscareno-11_a4oqzo">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-12.webp" alt="Tiscareno 12" data-index="91" data-cloudinary-id="tiscareno-12_hxvdrg">
                <img data-src="Assets/portafolio-sabrina-webp/tiscareno/tiscareno-13.webp" alt="Tiscareno 13" data-index="92" data-cloudinary-id="tiscareno-13_zzmt00">
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2026 Sabrina Chmaili. Todos los derechos reservados.</p>
            <div class="footer-links">
                <a href="aviso-legal.html">Aviso Legal</a>
                <a href="politica-privacidad.html">Política de Privacidad</a>
                <a href="politica-cookies.html">Política de Cookies</a>
                <a href="derechos-imagen.html">Derechos de Imagen</a>
                <a href="condiciones-uso.html">Condiciones de Uso</a>
            </div>
        </div>
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
        <div class="lightbox-overlay"></div>
        <button class="lightbox-close" aria-label="Cerrar lightbox">&times;</button>
        <button class="lightbox-nav lightbox-prev" aria-label="Imagen anterior">&#8249;</button>
        <button class="lightbox-nav lightbox-next" aria-label="Imagen siguiente">&#8250;</button>
        <div class="lightbox-container">
            <img id="lightbox-image" src="" alt="" class="lightbox-img">
        </div>
    </div>

    <!-- Script de lazy loading optimizado -->
    <script>
    (function() {
        // Sistema de cola para limitar imágenes cargando simultáneamente
        let loadingQueue = [];
        let maxConcurrentLoads = 4; // Máximo 4 imágenes cargando a la vez
        let currentLoads = 0;

        // Función para cargar imagen con límite de concurrencia
        function loadImage(img) {
            if (!img.dataset.src) return;

        // Si ya estamos cargando el máximo, añadir a la cola
        if (currentLoads >= maxConcurrentLoads) {
            loadingQueue.push(img);
            return;
        }

        // Incrementar contador de carga
        currentLoads++;
        
        // Guardar el src antes de eliminarlo
        const imageSrc = img.dataset.src;
        img.src = imageSrc;
        delete img.dataset.src;

        // Cuando la imagen cargue
        img.onload = function() {
            currentLoads--;
            this.classList.add('loaded');
            this.style.opacity = '1';
            
            // Cargar siguiente imagen en cola si hay alguna
            if (loadingQueue.length > 0) {
                loadImage(loadingQueue.shift());
            }
        };

        // Si hay error al cargar
        img.onerror = function() {
            currentLoads--;
            this.style.background = '#2a2a2a';
            this.style.minHeight = '200px';
            this.style.opacity = '0.5';
            
            // Cargar siguiente imagen en cola si hay alguna
            if (loadingQueue.length > 0) {
                loadImage(loadingQueue.shift());
            }
        };
    }

    // Configuración del lazy loading con Intersection Observer
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                loadImage(img);
                observer.unobserve(img);
            }
        });
    }, {
        rootMargin: '200px' // Cargar imágenes 200px antes de que sean visibles
    });

    // Inicializar cuando el DOM esté listo
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initLazyLoading);
    } else {
        initLazyLoading();
    }

    function initLazyLoading() {
        // Observar todas las imágenes con data-src
        const lazyImages = document.querySelectorAll('.portfolio-gallery img[data-src]');
        lazyImages.forEach(img => {
            imageObserver.observe(img);
        });
    }
    })();
    </script>

    <!-- Script del lightbox -->
    <script>
    (function() {
        const lightbox = document.getElementById('lightbox');
        const lightboxImage = document.getElementById('lightbox-image');
        const lightboxContainer = document.querySelector('.lightbox-container');
        const lightboxOverlay = document.querySelector('.lightbox-overlay');
        const closeBtn = document.querySelector('.lightbox-close');
        const prevBtn = document.querySelector('.lightbox-prev');
        const nextBtn = document.querySelector('.lightbox-next');
        
        let currentImageIndex = 0;
        let images = [];
        let scale = 1;
        let panX = 0;
        let panY = 0;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let startPanX = 0;
        let startPanY = 0;

        // Recopilar todas las imágenes con data-cloudinary-id
        function initImages() {
            const portfolioImages = document.querySelectorAll('.portfolio-gallery img[data-cloudinary-id]');
            images = Array.from(portfolioImages).map(img => ({
                cloudinaryId: img.getAttribute('data-cloudinary-id'),
                index: parseInt(img.getAttribute('data-index')),
                element: img // Guardar referencia al elemento img del grid
            }));
            images.sort((a, b) => a.index - b.index);
        }

        // Construir URL de Cloudinary
        function getCloudinaryUrl(cloudinaryId) {
            return `https://res.cloudinary.com/djrcv1cdb/image/upload/f_auto,q_auto:best/${cloudinaryId}`;
        }

        // Función helper para carga progresiva de imágenes
        function loadImageProgressive(imageData) {
            // Carga progresiva: primero mostrar imagen de baja calidad (la del grid)
            // Obtener el src actual: puede estar en src, data-src, o currentSrc
            let gridImgSrc = imageData.element.currentSrc || imageData.element.src;
            if (!gridImgSrc || gridImgSrc.includes('data:image')) {
                gridImgSrc = imageData.element.getAttribute('data-src') || imageData.element.src;
            }
            
            // Mostrar imagen de baja calidad inmediatamente
            if (gridImgSrc) {
                lightboxImage.src = gridImgSrc;
            }
            
            // Luego preload la imagen de alta calidad de Cloudinary
            const highQualityUrl = getCloudinaryUrl(imageData.cloudinaryId);
            const preloadImg = new Image();
            preloadImg.onload = function() {
                // Cuando se cargue la imagen de alta calidad, reemplazar
                lightboxImage.src = highQualityUrl;
            };
            preloadImg.src = highQualityUrl;
        }

        // Abrir lightbox
        function openLightbox(index) {
            currentImageIndex = index;
            const imageData = images[currentImageIndex];
            if (!imageData) return;

            // Cargar imagen con carga progresiva
            loadImageProgressive(imageData);
            
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Resetear zoom y pan
            scale = 1;
            panX = 0;
            panY = 0;
            updateTransform();
        }

        // Cerrar lightbox
        function closeLightbox() {
            lightbox.classList.remove('active');
            document.body.style.overflow = '';
            scale = 1;
            panX = 0;
            panY = 0;
            updateTransform();
        }

        // Navegar a imagen anterior
        function showPrev() {
            if (currentImageIndex > 0) {
                currentImageIndex--;
            } else {
                currentImageIndex = images.length - 1;
            }
            scale = 1;
            panX = 0;
            panY = 0;
            const imageData = images[currentImageIndex];
            // Usar carga progresiva también en navegación
            loadImageProgressive(imageData);
            updateTransform();
        }

        // Navegar a imagen siguiente
        function showNext() {
            if (currentImageIndex < images.length - 1) {
                currentImageIndex++;
            } else {
                currentImageIndex = 0;
            }
            scale = 1;
            panX = 0;
            panY = 0;
            const imageData = images[currentImageIndex];
            // Usar carga progresiva también en navegación
            loadImageProgressive(imageData);
            updateTransform();
        }

        // Actualizar transformación CSS (zoom + pan)
        function updateTransform() {
            lightboxImage.style.transform = `translate(${panX}px, ${panY}px) scale(${scale})`;
        }

        // Aplicar límites al pan cuando hay zoom
        function constrainPan() {
            const img = lightboxImage;
            const container = lightboxContainer;
            
            if (scale <= 1) {
                panX = 0;
                panY = 0;
                return;
            }

            const imgRect = img.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            const maxX = (imgRect.width * scale - containerRect.width) / 2;
            const maxY = (imgRect.height * scale - containerRect.height) / 2;
            
            panX = Math.max(-maxX, Math.min(maxX, panX));
            panY = Math.max(-maxY, Math.min(maxY, panY));
        }

        // Event listeners para clicks en imágenes
        function initLightbox() {
            initImages();
            
            // Click en imágenes del portfolio
            document.querySelectorAll('.portfolio-gallery img[data-cloudinary-id]').forEach((img, index) => {
                img.addEventListener('click', function() {
                    const imgIndex = images.findIndex(i => i.index === parseInt(this.getAttribute('data-index')));
                    if (imgIndex !== -1) {
                        openLightbox(imgIndex);
                    }
                });
            });

            // Cerrar con botón X
            closeBtn.addEventListener('click', closeLightbox);

            // Cerrar con click en overlay
            lightboxOverlay.addEventListener('click', function(e) {
                if (e.target === lightboxOverlay) {
                    closeLightbox();
                }
            });

            // Navegación con botones
            prevBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                showPrev();
            });
            nextBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                showNext();
            });

            // Zoom con rueda del mouse
            lightboxContainer.addEventListener('wheel', function(e) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -0.1 : 0.1;
                const oldScale = scale;
                scale = Math.max(1, Math.min(5, scale + delta));
                
                // Ajustar pan para mantener el punto bajo el cursor
                if (scale > 1 && oldScale !== scale) {
                    const rect = lightboxContainer.getBoundingClientRect();
                    const x = e.clientX - rect.left - rect.width / 2;
                    const y = e.clientY - rect.top - rect.height / 2;
                    
                    panX += x * (scale - oldScale) * 0.1;
                    panY += y * (scale - oldScale) * 0.1;
                }
                
                constrainPan();
                updateTransform();
            });

            // Drag para pan (solo cuando hay zoom)
            lightboxContainer.addEventListener('mousedown', function(e) {
                if (scale > 1) {
                    isDragging = true;
                    lightboxContainer.classList.add('dragging');
                    startX = e.clientX;
                    startY = e.clientY;
                    startPanX = panX;
                    startPanY = panY;
                    e.preventDefault();
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (isDragging && scale > 1) {
                    panX = startPanX + (e.clientX - startX);
                    panY = startPanY + (e.clientY - startY);
                    constrainPan();
                    updateTransform();
                }
            });

            document.addEventListener('mouseup', function() {
                if (isDragging) {
                    isDragging = false;
                    lightboxContainer.classList.remove('dragging');
                }
            });

            // Touch events para móvil
            let touchStartDistance = 0;
            let touchStartScale = 1;
            let touchStartPanX = 0;
            let touchStartPanY = 0;
            let touchStartCenterX = 0;
            let touchStartCenterY = 0;

            lightboxContainer.addEventListener('touchstart', function(e) {
                if (e.touches.length === 1) {
                    // Pan con un dedo
                    if (scale > 1) {
                        isDragging = true;
                        startX = e.touches[0].clientX;
                        startY = e.touches[0].clientY;
                        startPanX = panX;
                        startPanY = panY;
                    }
                } else if (e.touches.length === 2) {
                    // Zoom con dos dedos
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    touchStartDistance = Math.hypot(
                        touch2.clientX - touch1.clientX,
                        touch2.clientY - touch1.clientY
                    );
                    touchStartScale = scale;
                    touchStartPanX = panX;
                    touchStartPanY = panY;
                    touchStartCenterX = (touch1.clientX + touch2.clientX) / 2;
                    touchStartCenterY = (touch1.clientY + touch2.clientY) / 2;
                }
                e.preventDefault();
            });

            lightboxContainer.addEventListener('touchmove', function(e) {
                if (e.touches.length === 1 && isDragging && scale > 1) {
                    panX = startPanX + (e.touches[0].clientX - startX);
                    panY = startPanY + (e.touches[0].clientY - startY);
                    constrainPan();
                    updateTransform();
                } else if (e.touches.length === 2) {
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    const distance = Math.hypot(
                        touch2.clientX - touch1.clientX,
                        touch2.clientY - touch1.clientY
                    );
                    scale = Math.max(1, Math.min(5, touchStartScale * (distance / touchStartDistance)));
                    
                    const centerX = (touch1.clientX + touch2.clientX) / 2;
                    const centerY = (touch1.clientY + touch2.clientY) / 2;
                    const rect = lightboxContainer.getBoundingClientRect();
                    const offsetX = centerX - touchStartCenterX;
                    const offsetY = centerY - touchStartCenterY;
                    
                    panX = touchStartPanX + offsetX * (scale / touchStartScale);
                    panY = touchStartPanY + offsetY * (scale / touchStartScale);
                    
                    constrainPan();
                    updateTransform();
                }
                e.preventDefault();
            });

            lightboxContainer.addEventListener('touchend', function() {
                isDragging = false;
            });

            // Navegación con teclado
            document.addEventListener('keydown', function(e) {
                if (!lightbox.classList.contains('active')) return;

                switch(e.key) {
                    case 'Escape':
                        closeLightbox();
                        break;
                    case 'ArrowLeft':
                        showPrev();
                        break;
                    case 'ArrowRight':
                        showNext();
                        break;
                    case '+':
                    case '=':
                        e.preventDefault();
                        scale = Math.min(5, scale + 0.2);
                        constrainPan();
                        updateTransform();
                        break;
                    case '-':
                    case '_':
                        e.preventDefault();
                        scale = Math.max(1, scale - 0.2);
                        constrainPan();
                        updateTransform();
                        break;
                }
            });
        }

        // Inicializar cuando el DOM esté listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initLightbox);
        } else {
            initLightbox();
        }
    })();
    </script>

    <!-- Script para navbar con scroll -->
    <script>
    (function() {
        const navigation = document.querySelector('.navigation');
        if (!navigation) return;

        function handleScroll() {
            // Añadir clase 'scrolled' cuando el scroll sea mayor a 50px
            // Puedes ajustar este valor (50) para cambiar el punto de inicio del fade
            if (window.scrollY > 50) {
                navigation.classList.add('scrolled');
            } else {
                navigation.classList.remove('scrolled');
            }
        }

        // Ejecutar al cargar y al hacer scroll
        window.addEventListener('scroll', handleScroll);
        handleScroll(); // Verificar estado inicial
    })();
    </script>
</body>
</html>

